## 0. 회사 생활 중 첫 배포 경험 
최근 회사에서 NextJS 프로젝트를 서버에 배포하는 임무를 맡아 진행하게 되었다. 사실 실제 운영 서버나 개발 서버에 배포한 것도 아니고 그냥 데모 용 웹사이트를 띄우기 위해 임시 서버에 잠깐 올리는 것 이긴 하였지만 그래도 회사와서 처음으로 서버에 

스프링은 몇 번 배포해봤지만 Next JS 는 아직 배포 해본 적이 없어서 인터넷과 ai 를 적극 활용하였다. 스프링 어플리케이션 도커 배포와 크게 다를 건 없었지만 그래도 처음은 처음인 지라 (사실 NextJS 자체가 처음,,) 조금 시행 착오를 겪었다. 그래서 간 만에 블로그 글도 채울 겸 내가 겪었던 시행착오 및 새로 알게 된 것들을 기록해보고자 한다. 

## 1. 첫 번째 문제 : 너무 무거운 Docker 이미지

### Dockerfile
```shell
FROM node:20-alpine

WORKDIR /app

# 의존성 파일 복사

COPY package.json package-lock.json* ./

# 의존성 설치
RUN npm ci

# 소스 코드 복사
COPY . .
  
# Next.js 애플리케이션 빌드
RUN npm run build
  
# 애플리케이션 실행을 위한 포트 노출
EXPOSE 3000

# 애플리케이션 실행
CMD ["npm", "start"]
```
사실 조금 급히 배포를 했어야하는 상황이라 인터넷을 최대한 빨리 검색하여 급히 Dockerfile 을 작성하였는데 그러다보니 도커이미지 용량이 너무 무거워지는 일이 발생했다. 

![[Pasted image 20250511161547.png]]
보다시피 1.34 GB 를 차지하고있는것을 확인 할 수 있다.  같은 서버내에 스프링 부트 이미지는 250MB 밖에 되지 않는걸 생각해본다면 너무 말도안되는 용량인것임을 알 수 있다.

