
## 발단
현재 우리 백엔드 프로젝트는 자바 계열에서 주로 쓰는 정적 분석 도구인 "체크스타일" 을 이용하여 컨벤션을 준수 하고 있었다. 그런데 언제부턴가 인덴트 라던지 공백 등 컨벤션이 제대로 지켜지지 않는 코드들이 중간 중간 발생하여 CI 가 실패하는 현상이 벌여졌다.

## 문제 원인
우리는 ``pre-commit`` 이라는 깃훅을 이용하여 커밋 하기 전에 build.gradle 에 정의한 checkstyle 태스크를 실행하도록 설정해놓았다. 그래서 공용으로 사용할 ``pre-commit`` 파일을 작성 한 다음, Git Wiki 에 가이드라인과 함께 공유해놓았다. 팀원들은 가이드에 맞춰 각자 로컬 환경에서 ``pre-commit`` 작성해주면 끝이였다.

![[Pasted image 20250519001257.png]]

문제는 로컬 개발 환경이 달라질 경우, 즉, 새롭게 git clone 을 받은 경우 ``.git`` 폴더가 새로 생성 되기 때문에  매번 ``pre-commit`` 파일을 다시 수정해줘야했다. 그렇기 때문에 **혹시나 깜빡하고 ``pre-commit`` 을 정의하지 않은 경우** 체크스타일 검수가 이뤄지지 않은 채로 코드가 커밋되고 푸쉬된것이였다. 

> 🤔 매번 프로젝트를 clone 받을 때마다 일일이 pre-commit 을 설정하지 않고 자동으로 공유되고 적용 시킬 순 없을까?
## 해결책

앞서 살펴본 문제 원인을 통해 우리가 보완 및 개선해야 할 점은
1. 깃 훅은 자동으로 공유 되어야한다.
2. 프로젝트 생성 (git clone) 시 마다 깃 훅 설정을 다시할 필요가 없어야한다.

이 두가지를 해결 하기 위해 다음 두 작업을 실시했다.
### 1. core.hooksPath 를 변경하여 깃 훅을 공유하고 중앙에서 관리하자
기존 깃 훅들의 문제점은 공유가 되지 않는다는 것이였다. 기본적으로 깃 훅은 ``.git/hooks`` 안에 존재하기 때문에 공유 될 수가 없었다. 이런 문제 때문에 깃은 2.9 버전 부터 ``core.hooksPath`` 설정을 통해 ``hooks`` 디렉토리의 위치를 임의로 지정 할 수 있게 되었다. 
![[Pasted image 20250519004729.png]]

이렇게 루트에 ``.githooks`` 라는 폴더를 만든 다음, 

```shell
git config core.hooksPath .githooks
```

라고 명령어를 입력해준뒤, 앞으로 git-hooks 들을 이곳에 저장해두면 끝이다. 

이럴 경우 버전관리도 되며 공유도 할 수 있게 되었다.

### 2. build.gradle 에 깃 훅 설정 스크립트 작성
사실 1번까지만 해도 거진 모든 자동화가 끝이 난 것이다. 하지만, 인간의 욕심은 끝이 없는법. 

이렇게 할 지라도 